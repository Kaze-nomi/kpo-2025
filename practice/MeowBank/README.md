# Общая идея решения

---

## Реализованный функционал

### Управление банковскими сущностями

- Счета (BankAccount)

- Категории операций (Category)

- Финансовые операции (Operation)

- Получение различной информации о вышеупомянутых сущностях

### Импорт/экспорт данных

- Поддержка форматов: JSON, YAML, CSV

- Автоматическое сохранение данных при завершении работы

### Система отчётов

- Генерация логов операций (ReportOperationObserver)

- Полная прозрачность операций, всё что сделал пользователь, будет видно в отчётах

- Паттерн Builder для формирования отчётов (ReportBuilder)

---

# Реализованные принципы SOLID и GRASP

## SOLID

### Single Responsibility

- BankAccountService — управление счетами

- CategoryService — управление категориями

- OperationService — обработка операций

- Импортеры/Экспортеры — только загрузка/сохранение данных


### Open/Closed

- Интерфейсы IDataImporter и IDataExporter позволяют добавлять новые форматы без изменения существующего кода

- DataImporterFactory и DataExporterFactory реализуют открытость для расширения

### Liskov Substitution

- Все импортеры (JsonDataImporter, YAMLDataImporter, CSVDataImporter) взаимозаменяемы через общий интерфейс

### Interface Segregation

- Раздельные интерфейсы для провайдеров: IBankAccountProvider, ICategoryProvider, IOperationProvider

### Dependency Inversion

- Внедрение зависимостей через конструкторы (Lombok @RequiredArgsConstructor) и Spring

- HSEBank зависит от абстракций (IOperationProvider)

## GRASP

### Information Expert

- BankAccountService — эксперты по работе со счетами

- OperationService — эксперты по финансовым операциям

### Creator

- Фабрики (BankAccountFactory, CategoryFactory) создают объекты доменной модели

### Controller

- Класс HSEBank обрабатывает высокоуровневые команды

### Low Coupling

- Модули взаимодействуют через интерфейсы (например, IOperationObserver)

- Отсутствие прямых ссылок между импортерами и сервисами

### High Cohesion

- Каждый сервис (*Service) имеет строго определённую зону ответственности

---

# Реализованные паттерны GoF

## Фасад (Facade)

- Классы: HSEBank

- Описание: Предоставляет унифицированный интерфейс для работы с подсистемой банковских операций.

- Важность: Скрывает сложность взаимодействия с сервисами (аккаунты, категории, операции) и импортерами/экспортерами.

## Наблюдатель (Observer)

- Описание: Отслеживает изменения операций и генерирует логи для отчётов.

- Важность: Позволяет реагировать на события (создание/изменение/удаление сущностей) без жесткой связности.

- Классы: ReportOperationObserver, IOperationObserver

## Строитель (Builder)

- ReportBuilder для поэтапного создания сложных отчётов

- Важность: Гибкое конструирование объектов с переменным составом данных

- Классы: ReportBuilder, Report

## Фабрика (Factory)

- Описание: Создают объекты доменной модели.

- Важность: Инкапсулирует логику создания объектов.

- Классы: BankAccountFactory, CategoryFactory, OperationFactory

## Фабричный метод (Factory Method)

- DataImporterFactory и DataExporterFactory создают объекты по формату

- Важность: Инкапсуляция логики создания объектов

- Классы: DataImporterFactory, DataExporterFactory

## Сервисный слой (Service Layer)

- Описание: Выделяет бизнес-логику в отдельные сервисы.

- Важность: Отделяет слой работы с данными от представления и управления операциями.

- Классы: BankAccountService, CategoryService, OperationService

## Стратегия (Strategy)

- Описание: Алгоритмы импорта/экспорта инкапсулированы в отдельные классы и взаимозаменяемы.

- Важность: Позволяет динамически выбирать формат обработки данных без изменения клиентского кода.

- Классы: IDataImporter, IDataExporter, их реализации (JsonDataImporter, CSVDataImporter, YAMLDataImporter)

## Внедрение зависимостей (Dependency Injection)

- Описание: Зависимости внедряются через конструкторы (Lombok @RequiredArgsConstructor).

- Важность: Уменьшает связанность компонентов, упрощает тестирование.

- Классы: Все Spring-бины (например, HSEBank, OperationService)

## Синглтон (Singleton)

- Описание: Объекты создаются Spring-контейнером как синглтоны.

- Важность: Гарантирует единственность экземпляра сервисов.

- Классы: Spring-бины (например, HSEBank, OperationService).

## Адаптер (Adapter)

- Импортеры адаптируют различные форматы данных к единому интерфейсу

- Важность: Унификация работы с разными источниками данных

- Классы: JsonDataImporter, CSVDataImporter

## Состояние (State)

- OperationType определяет поведение при генерации сообщений

- Важность: Инкапсуляция вариантов поведения операций

- Классы: OperationType

---

# Инструкция по запуску main

1. Запустить ./gradlew bootRun --console=plain

# Также, можно запустить тесты и проверить покрытие через плагин JaCoCo.

1. Запустить ./gradlew test (результаты в build/reports/tests/test/index.html)

2. Посмотреть покрытие тестов JaCoCo (build/reports/jacoco/test/html/index.html)

P.S. Тесты приводят к очищению файлов сохранения и лога.

---

# Руководство пользователя для банковского приложения

## Запуск приложения

При запуске приложения пользователю будет предложено выбрать формат загрузки данных (CSV, JSON или YAML). Далее независимо от того были ли загружены данные из файла, пользователь сможет вводить команды для управления банковским приложением. (Файлы сохранения будут созданы автоматически после завершения программы)

## Команды

### Создание аккаунта

Команда: СоздатьАккаунт <имя_аккаунта>

Описание: Создает новый банковский аккаунт с указанным именем.

### Создание категории

Команда: СоздатьКатегорию <имя_категории> <тип>

Описание: Создает новую категорию с указанным именем и типом. Тип может быть true (доход) или false (расход).

### Добавление операции

Команда: ДобавитьОперацию <ID_аккаунта> <сумма> <описание> <ID_категории>

Описание: Добавляет новую операцию для указанного аккаунта. Необходимо указать сумму, описание и ID категории.

### Изменение описания операции

Команда: ИзменитьОписаниеОпирации <ID_операции> <новое_описание>

Описание: Изменяет описание операции с указанным ID.

### Изменение категории операции

Команда: ИзменитьКатегориюОперации <ID_операции> <новый_ID_категории>

Описание: Изменяет категорию операции с указанным ID. Если тип новой категории отличается от типа текущей, то тип операции будет изменён и баланс аккаунта пересчитан.

### Изменение имени аккаунта

Команда: ИзменитьИмяАккаунта <ID_аккаунта> <новое_имя>

Описание: Изменяет имя аккаунта с указанным ID.

### Изменение имени категории

Команда: ИзменитьИмяКатегории <ID_категории> <новое_имя>

Описание: Изменяет имя категории с указанным ID.

### Изменение типа категории

Команда: ИзменитьТипКатегории <ID_категории> <новый_тип>

Описание: Изменяет тип категории с указанным ID. Тип может быть true (доход) или false (расход). Типы всех операций привязанных к категории пересчитаются. Балансы всех аккаунтов привязанных к операциям будут пересчитаны.

### Удаление операции

Команда: УдалитьОперацию <ID_операции>

Описание: Удаляет операцию с указанным ID.

### Удаление аккаунта

Команда: УдалитьАккаунт <ID_аккаунта>

Описание: Удаляет аккаунт с указанным ID. Все операции привязанные к аккаунты также будут удалены.

### Удаление категории

Команда: УдалитьКатегорию <ID_категории>

Описание: Удаляет категорию с указанным ID.

### Вывод списка аккаунтов

Команда: ВывестиАккаунты

Описание: Выводит список всех аккаунтов.

### Вывод списка категорий

Команда: ВывестиКатегории

Описание: Выводит список всех категорий.

### Вывод списка операций

Команда: ВывестиОперации

Описание: Выводит список всех операций.

### Вывод общего баланса

Команда: ВывестиОбщийБаланс

Описание: Выводит общий баланс всех аккаунтов.

### Выход из приложения

Команда: Выход

Описание: Завершает работу приложения.

### Замечания

Каждый раз перед выходом из приложения данные автоматически сохраняются в файлы data.json, data.yml и data.csv в директорию ./record.

Каждое действие пользователя записывается в файл history.log в директории ./report.

ID сущностей присваиваются автоматически (начинаются с 0).
